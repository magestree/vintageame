var $special,resizeTimeout,$event=$.event;$special=$event.special.debouncedresize={setup:function(){$(this).on("resize",$special.handler)},teardown:function(){$(this).off("resize",$special.handler)},handler:function(e,i){var a=this,t=arguments,n=function(){e.type="debouncedresize",$event.dispatch.apply(a,t)};resizeTimeout&&clearTimeout(resizeTimeout),i?n():resizeTimeout=setTimeout(n,$special.threshold)},threshold:250};var BLANK="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";$.fn.imagesLoaded=function(e){var i=this,a=$.isFunction($.Deferred)?$.Deferred():0,t=$.isFunction(a.notify),n=i.find("img").add(i.filter("img")),o=[],d=[],s=[];function r(){var t=$(d),o=$(s);a&&(s.length?a.reject(n,t,o):a.resolve(n)),$.isFunction(e)&&e.call(i,n,t,o)}function h(e,i){e.src!==BLANK&&-1===$.inArray(e,o)&&(o.push(e),i?s.push(e):d.push(e),$.data(e,"imagesLoaded",{isBroken:i,src:e.src}),t&&a.notifyWith($(e),[i,n,$(d),$(s)]),n.length===o.length&&(setTimeout(r),n.unbind(".imagesLoaded")))}return $.isPlainObject(e)&&$.each(e,function(i,t){"callback"===i?e=t:a&&a[i](t)}),n.length?n.bind("load.imagesLoaded error.imagesLoaded",function(e){h(e.target,"error"===e.type)}).each(function(e,i){var a=i.src,t=$.data(i,"imagesLoaded");t&&t.src===a?h(i,t.isBroken):i.complete&&void 0!==i.naturalWidth?h(i,0===i.naturalWidth||0===i.naturalHeight):(i.readyState||i.complete)&&(i.src=BLANK,i.src=a)}):r(),a?a.promise(i):i};var PureGrid=function(){var e=$("#og-grid"),i=e.children("li"),a=-1,t=0,n=(Modernizr.prefixed("transition"),Modernizr.csstransitions,$("html, body")),o={minHeight:500,speed:350,marginBottom:20,easing:"ease"};function d(e){i.each(function(){var i=$(this),a=i.find(".og-expander");i.data("offsetTop",i.offset().top),e&&(i.data("height",i.height()),a.css({height:"auto"}).data("height",a.height()).css({height:0}))})}return{init:function(s){o=$.extend(!0,{},o,s),e.imagesLoaded(function(){$(".flexslider").flexslider({animation:"fade",slideshow:!1,animationLoop:!0,animationSpeed:"3000",slideshowSpeed:"8000",controlNav:!1}),d(!0),i.on("click","span.og-close",function(){return i.eq(a),a=-1,i.removeClass("expanded").find(".og-expander").animate({opacity:"0"},500,function(){i.find(".og-expander").css({height:0}),i.animate({height:i.data("height")},200)}),!1}).children("a.grid-item-image").on("click",function(e){e.preventDefault();var i=$(this).parent();return i.hasClass("clickable")&&(i.hasClass("expanded")||function(e){var i=e.find(".og-expander"),d=e.find("a.grid-item-image .dynamic-portfolio-holder"),s=e.find(".hover-icon");if(offsetTop=e.offset().top,a=e.index(),e.addClass("loading"),s.addClass("loading"),totalheight=i.data("height")+d.height()+o.marginBottom,offsetTop!==t&&0!==t){var r=$("#og-grid li.expanded");r.removeClass("expanded").find(".og-expander").animate({height:0,opacity:"0"},500,function(){r.animate({height:r.data("height")},200)}),e.addClass("expanded").animate({height:totalheight},500,function(){i.css({height:i.data("height")}).animate({opacity:"1"},500,function(){t=$("#og-grid li.expanded").offset().top,n.animate({scrollTop:t},o.speed),e.removeClass("loading").delay(800).find(".hover-icon").removeClass("loading")})})}else{var r=$("#og-grid li.expanded");e.addClass("expanded").animate({height:totalheight},500,function(){i.css({height:i.data("height")}).animate({opacity:"1"},200,function(){}),r.animate({height:r.data("height")}).removeClass("expanded").find(".og-expander").css({height:0}).css({opacity:"0"}),t=$("#og-grid li.expanded").offset().top,n.animate({scrollTop:t},o.speed),e.removeClass("loading").delay(800).find(".hover-icon").removeClass("loading")})}}(i)),!1}),$(window).on("debouncedresize",function(){d(!0),scrollExtra=0,previewPos=-1,$newheight=$("#og-grid li:first-child .dynamic-portfolio-holder").height(),i.each(function(){var e=$(this);e.stop().animate({height:$newheight})}),$expanded=$("#og-grid li.expanded"),$expanded.removeClass("expanded").find(".og-expander").animate({opacity:"0"},500,function(){$expanded.find(".og-expander").css({height:0})})})})}}}();